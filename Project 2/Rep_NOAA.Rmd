---
title: "Finding the most severe storms"
author: "Juan C. López Tavera"
date: "9/22/2017"
output: html_document
---


```{r setup, include=TRUE, message=FALSE}
# Setting up the report
## Loading the necessary package for reproducing the assingment
if (!require(knitr)) {
    install.packages("knitr")
}
library(knitr)

if (!require(tidyverse)) {
    install.packages("tidyverse")
}
library(tidyverse)

## Setting up all code chunks according to the assignment specs
knitr::opts_chunk$set(
    eval = TRUE,
    echo = TRUE,
    tidy = TRUE,
    results = "markup",
    include = TRUE,
    message = FALSE,
    warning = FALSE,
    knitr.table.format = "markdown",
    tidy.opts = list(width.cutoff = 80),
    fig.align = "center",
    fig.path = "figure/",
    highlight = TRUE
)

```


## Introduction

This is a reproducible research report made with knitr for completing the requirements of the JHU's Reproducible Research Course. 

This documents describe the exploration of U.S. National Oceanic and Atmospheric Administration's (NOAA) storm database, which tracks weather phenomena, their characteristics and casualties caused by them. 

The main objective of this data exploration is to answer the questions:

1. Across the USA, which types of events are most harmful with respect to population health?
2. Across the USA, which types of events have the greatest economic consequences?


## Data processing 

### Data downloading and reading

First, if necessary, we donwload the data BZ2 file from the link provided in the course assignment page; then, we read the data into the working environment, and conveniently cache the result of the computation.  

```{r data loading, cache=TRUE}
URL <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2"
        
path <- paste0(getwd(), "/repdata%2Fdata%2FStormData.csv.bz2")
        
if (!file.exists(path)) {
        download.file(url = URL,
                destfile = path)
        }
        
storm_data <- read_csv(file = path, progress = FALSE)

```


We need to know our dataset, so we explore its structure: we have a tibble data frame of `r nrow(storm_data)` rows by `r ncol(storm_data)` columns, with `r sum(is.na(storm_data))` missing values, which are `r round(mean(is.na(storm_data))*100, 2)`% of the observations.

The classes of the NOAA storm database, `storm_data`, and the proportion of missing values for each column are shown in the following table:

```{r data processing}

classes <-
sapply(storm_data, class) %>% 
        as_data_frame() %>% 
        rownames_to_column("Variable Name") %>% 
        select(`Variable Name`, Value = value)

classes$`Percent of NAs` <- sapply(storm_data, function(x)
        round(mean(is.na(x)) * 100, 2))

kable(classes %>% arrange(desc(`Percent of NAs`)))

```

We can observe that there are variables that have as much as 100% of NAs! 




## Results

### Most harmful meteorological events

Across the United States, which types of events (as indicated in the 𝙴𝚅𝚃𝚈𝙿𝙴 variable) are most harmful with respect to population health?

```{r harmful events}

```


### Most costly meteorological events

Across the United States, which types of events have the greatest economic consequences?

```{r costly events}

```





